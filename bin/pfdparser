#!/usr/bin/env node

var _ = require('highland'),
    program = require('commander'),
    pkg = require('../package.json'),
    parser = require('../'),
    fs = require('fs');

program
    .version(pkg.version);

program
    .usage('<filings path> <data path>')
    .action((filingsPath, dataPath, options) => {
        _(parser(filingsPath))
            .flatten()
            .flatMap((filing) => {
                console.log(filing.file);

                return _(filing.save(dataPath))
            })
            .done(() => console.log('done'));
    });

program.parse(process.argv);

if (!process.argv.slice(2).length) {
    program.outputHelp();
}
